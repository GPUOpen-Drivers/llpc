; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --tool cross-module-inline --version 3
; RUN: cross-module-inline %s %S/inc/link-global-same-struct.ll --link inline_fun | FileCheck %s
;
; Have a global with an equal struct in both modules. Check that linking creates a second global.

%struct.MyStruct = type { i32, i32 }

@glob = external global %struct.MyStruct

declare i32 @inline_fun()

define i32 @main() {
; CHECK-LABEL: define i32 @main() {
; CHECK-NEXT:    [[RESULT_I:%.*]] = load i32, ptr getelementptr inbounds ([[STRUCT_MYSTRUCT_0:%.*]], ptr @"glob.cloned.{{.*}}", i64 0, i32 1), align 4
; CHECK-NEXT:    ret i32 [[RESULT_I]]
;
  %result = call i32 @inline_fun()
  ret i32 %result
}
