; NOTE: Assertions have been autogenerated by tool/update_llpc_test_checks.py UTC_ARGS: --tool lgc
; RUN: lgc -o - --mcpu=gfx1100 --emit-llvm %s | FileCheck -check-prefixes=CHECK %s

define dllexport void @lgc.shader.CS() #0 !lgc.shaderstage !0 {
entry:
  %rsrc = call <8 x i32> addrspace(4)* (...) @lgc.create.get.desc.ptr.p4v8i32(i32 1, i32 1, i32 0, i32 1)
  %sampler = call <4 x i32> addrspace(4)* (...) @lgc.create.get.desc.ptr.p4v4i32(i32 2, i32 2, i32 0, i32 2)
  %addr.tmp = insertelement <2 x float> undef, float 0.000000e+00, i64 0
  %addr = insertelement <2 x float> %addr.tmp, float 0.000000e+00, i64 1
  call void @lgc.create.image.sample(i32 1, i32 0, <8 x i32> addrspace(4)* %rsrc, <4 x i32> addrspace(4)* %sampler, i32 1, <2 x float> %addr)
  ret void
}

; Function Attrs: nounwind readnone
declare <8 x i32> addrspace(4)* @lgc.create.get.desc.ptr.p4v8i32(...) #1

; Function Attrs: nounwind readnone
declare <4 x i32> addrspace(4)* @lgc.create.get.desc.ptr.p4v4i32(...) #1

; Function Attrs: nounwind
declare void @lgc.create.image.sample(...) #0

attributes #0 = { nounwind }
attributes #1 = { nounwind readnone }

!lgc.user.data.nodes = !{!1, !2, !3}
!lgc.color.export.formats = !{!4}

!0 = !{i32 7}
!1 = !{!"DescriptorTableVaPtr", i32 0, i32 0, i32 11, i32 1, i32 1}
!2 = !{!"DescriptorResource", i32 1, i32 0, i32 0, i32 80, i32 0, i32 1, i32 8}
!3 = !{!"DescriptorSampler", i32 2, i32 0, i32 -1, i32 4, i32 0, i32 2, i32 4, i32 12288, i32 117436416, i32 1750073344, i32 -2147483648}
!4 = !{i32 10, i32 0, i32 0, i32 0, i32 15}
; CHECK-LABEL: @_amdgpu_cs_main(
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[TMP0:%.*]] = call i64 @llvm.amdgcn.s.getpc()
; CHECK-NEXT:    [[TMP1:%.*]] = and i64 [[TMP0]], -4294967296
; CHECK-NEXT:    [[TMP2:%.*]] = zext i32 [[USERDATA11:%.*]] to i64
; CHECK-NEXT:    [[TMP3:%.*]] = or disjoint i64 [[TMP1]], [[TMP2]]
; CHECK-NEXT:    [[TMP4:%.*]] = inttoptr i64 [[TMP3]] to ptr addrspace(4)
; CHECK-NEXT:    call void @llvm.assume(i1 true) [ "align"(ptr addrspace(4) [[TMP4]], i32 4), "dereferenceable"(ptr addrspace(4) [[TMP4]], i32 -1) ]
; CHECK-NEXT:    [[TMP5:%.*]] = load <8 x i32>, ptr addrspace(4) [[TMP4]], align 4, !invariant.load !4
; CHECK-NEXT:    call void @llvm.amdgcn.image.sample.2d.nortn.f16{{(\.v8i32)?}}{{(\.v4i32)?}}(i32 15, half 0xH0000, half 0xH0000, <8 x i32> [[TMP5]], <4 x i32> <i32 12288, i32 117436416, i32 1750073344, i32 -2147483648>, i1 false, i32 0, i32 0)
; CHECK-NEXT:    ret void
;
