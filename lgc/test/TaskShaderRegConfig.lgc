; NOTE: Assertions have been autogenerated by tool/update_llpc_test_checks.py UTC_ARGS: --tool lgc --check-pal-metadata
; Test that relevant registers of task shader are built as expected.

; RUN: lgc -mcpu=gfx1030 -o - -filetype=asm %s | FileCheck --check-prefixes=CHECK %s

; ModuleID = 'lgcPipeline'
source_filename = "llpctask1"
target datalayout = "e-p:64:64-p1:64:64-p2:32:32-p3:32:32-p4:64:64-p5:32:32-p6:32:32-i64:64-v16:16-v24:32-v32:32-v48:64-v96:128-v192:256-v256:256-v512:512-v1024:1024-v2048:2048-n32:64-S32-A5-G1-ni:7"
target triple = "amdgcn--amdpal"

; Function Attrs: nounwind
define dllexport spir_func void @lgc.shader.TASK.main() local_unnamed_addr #0 !lgc.shaderstage !7 {
.entry:
  ret void
}

attributes #0 = { nounwind }

!llpc.compute.mode = !{!0}
!lgc.client = !{!1}
!lgc.unlinked = !{!2}
!lgc.options = !{!3}
!lgc.options.TASK = !{!4}
!lgc.input.assembly.state = !{!5}
!amdgpu.pal.metadata.msgpack = !{!6}

!0 = !{i32 32, i32 1, i32 1}
!1 = !{!"Vulkan"}
!2 = !{i32 1}
!3 = !{i32 -818902704, i32 391257630, i32 857742121, i32 -2057576994, i32 1, i32 0, i32 0, i32 552, i32 0, i32 0, i32 1, i32 256, i32 256, i32 2}
!4 = !{i32 1926140008, i32 -922063099, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 64, i32 0, i32 0, i32 3, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 20, i32 1800}
!5 = !{i32 0, i32 3}
!6 = !{!"\82\B0amdpal.pipelines\91\84\AA.registers\80\B0.spill_threshold\CE\FF\FF\FF\FF\B0.user_data_limit\00\AF.xgl_cache_info\82\B3.128_bit_cache_hash\92\CF*\B3\1C8\12\A8\7F\8D\CF\0B\01_tf\C7\1A\C5\AD.llpc_version\A452.2\AEamdpal.version\92\02\03"}
!7 = !{i32 0}
; CHECK-LABEL: amdgpu_cs_main:
; CHECK:         s_endpgm
;
; CHECK-LABEL: .amdgpu_pal_metadata
; CHECK-NEXT: ---
; CHECK-NEXT: amdpal.pipelines:
; CHECK-NEXT:   - .api:            Vulkan
; CHECK-NEXT:     .compute_registers:
; CHECK-NEXT:       .tg_size_en:     true
; CHECK-NEXT:       .tgid_x_en:      true
; CHECK-NEXT:       .tgid_y_en:      true
; CHECK-NEXT:       .tgid_z_en:      true
; CHECK-NEXT:       .tidig_comp_cnt: 0
; CHECK-NEXT:     .graphics_registers:
; CHECK-NEXT:       .aa_coverage_to_shader_select: InputCoverage
; CHECK-NEXT:       .pa_sc_shader_control:
; CHECK-NEXT:         .wave_break_region_size: 0
; CHECK-NEXT:     .hardware_stages:
; CHECK-NEXT:       .cs:
; CHECK-NEXT:         .checksum_value: 0xbbc4ff6d
; CHECK-NEXT:         .debug_mode:     false
; CHECK-NEXT:         .entry_point:    _amdgpu_cs_main
; CHECK-NEXT:         .excp_en:        0
; CHECK-NEXT:         .float_mode:     0xc0
; CHECK-NEXT:         .ieee_mode:      false
; CHECK-NEXT:         .lds_size:       0
; CHECK-NEXT:         .mem_ordered:    true
; CHECK-NEXT:         .scratch_en:     false
; CHECK-NEXT:         .scratch_memory_size: 0
; CHECK-NEXT:         .sgpr_count:     0xa
; CHECK-NEXT:         .sgpr_limit:     0x6a
; CHECK-NEXT:         .threadgroup_dimensions:
; CHECK-NEXT:           - 0x20
; CHECK-NEXT:           - 0x1
; CHECK-NEXT:           - 0x1
; CHECK-NEXT:         .trap_present:   false
; CHECK-NEXT:         .user_data_reg_map:
; CHECK-NEXT:           - 0x10000000
; CHECK-NEXT:           - 0x10000012
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0x10000013
; CHECK-NEXT:           - 0x10000014
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:           - 0xffffffff
; CHECK-NEXT:         .user_sgprs:     0x6
; CHECK-NEXT:         .vgpr_count:     0x3
; CHECK-NEXT:         .vgpr_limit:     0x100
; CHECK-NEXT:         .wavefront_size: 0x20
; CHECK-NEXT:         .wgp_mode:       false
; CHECK-NEXT:     .internal_pipeline_hash:
; CHECK-NEXT:       - 0x{{[0-9a-f]+}}
; CHECK-NEXT:       - 0x{{[0-9a-f]+}}
; CHECK-NEXT:     .registers:      {}
; CHECK-NEXT:     .shaders:
; CHECK-NEXT:       .task:
; CHECK-NEXT:         .api_shader_hash:
; CHECK-NEXT:           - 0x{{[0-9a-f]+}}
; CHECK-NEXT:           - 0
; CHECK-NEXT:         .hardware_mapping:
; CHECK-NEXT:           - .cs
; CHECK-NEXT:     .spill_threshold: 0xffff
; CHECK-NEXT:     .user_data_limit: 0x1
; CHECK-NEXT:     .xgl_cache_info:
; CHECK-NEXT:       .128_bit_cache_hash:
; CHECK-NEXT:         - 0x{{[0-9a-f]+}}
; CHECK-NEXT:         - 0x{{[0-9a-f]+}}
; CHECK-NEXT:       .llpc_version: {{.*}}
; CHECK-NEXT: amdpal.version:
; CHECK-NEXT:   - 0x3
; CHECK-NEXT:   - 0
; CHECK-NEXT: ...
