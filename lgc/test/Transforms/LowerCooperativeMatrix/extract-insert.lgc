; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --tool lgc
; RUN: lgc -o - -passes=lgc-lower-cooperative-matrix %s | FileCheck --check-prefixes=CHECK %s

define i32 @test_length_f16() !spirv.ExecutionModel !8 !lgc.shaderstage !9 {
; CHECK-LABEL: @test_length_f16(
; CHECK-NEXT:    [[A:%.*]] = call i32 (...) @lgc.cooperative.matrix.length__i32(i32 1, i32 0)
; CHECK-NEXT:    ret i32 [[A]]
;
  %a = call i32 (...) @lgc.cooperative.matrix.length__i32(i32 1, i32 0)
  ret i32 %a
}

define half @test_extract_f16(<8 x float> %matrix) !spirv.ExecutionModel !8 !lgc.shaderstage !9 {
; CHECK-LABEL: @test_extract_f16(
; CHECK-NEXT:    [[TMP1:%.*]] = bitcast <8 x float> [[MATRIX:%.*]] to <16 x half>
; CHECK-NEXT:    [[TMP2:%.*]] = extractelement <16 x half> [[TMP1]], i32 5
; CHECK-NEXT:    ret half [[TMP2]]
;
  %r = call half (...) @lgc.cooperative.matrix.extract__f16(<8 x float> %matrix, i32 5, i32 1, i32 0)
  ret half %r
}

define <8 x float> @test_insert_f16(<8 x float> %matrix, half %x) !spirv.ExecutionModel !8 !lgc.shaderstage !9 {
; CHECK-LABEL: @test_insert_f16(
; CHECK-NEXT:    [[TMP1:%.*]] = bitcast <8 x float> [[MATRIX:%.*]] to <16 x half>
; CHECK-NEXT:    [[TMP2:%.*]] = insertelement <16 x half> [[TMP1]], half [[X:%.*]], i32 5
; CHECK-NEXT:    [[TMP3:%.*]] = bitcast <16 x half> [[TMP2]] to <8 x float>
; CHECK-NEXT:    ret <8 x float> [[TMP3]]
;
  %r = call <8 x float> (...) @lgc.cooperative.matrix.insert__v8f32(<8 x float> %matrix, half %x, i32 5, i32 1, i32 0)
  ret <8 x float> %r
}

declare i32 @lgc.cooperative.matrix.length__i32(...)
declare half @lgc.cooperative.matrix.extract__f16(...)
declare <8 x float> @lgc.cooperative.matrix.insert__v8f32(...)

!llpc.compute.mode = !{!0}
!lgc.client = !{!1}
!lgc.options = !{!2}
!lgc.options.CS = !{!3}

!0 = !{i32 128, i32 2, i32 1}
!1 = !{!"Vulkan"}
!2 = !{i32 -2108299168, i32 -1199997545, i32 1667044824, i32 -422575072, i32 1, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 1, i32 0, i32 0, i32 -1}
!3 = !{i32 219437737, i32 -1317595285, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 64, i32 64, i32 0, i32 0, i32 3, i32 0, i32 0, i32 0, i32 0, i32 0, i32 0, i32 20, i32 1800}
!8 = !{i32 5}
!9 = !{i32 7}
