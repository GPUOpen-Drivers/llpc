; NOTE: Assertions have been autogenerated by tool/update_llpc_test_checks.py
; RUN: amdllpc -o - -filetype=asm %s | FileCheck -check-prefixes=CHECK %s
[Version]
version = 70

[FsGlsl]
#version 450
layout(location = 0) out highp vec4 o_color;
layout(set = 1, binding = 1) uniform buf
{
  vec4 colorTop;
  vec4 colorBot;
};

void main()
{
  const int middle = 8;
  o_color          = int(gl_FragCoord.y - 0.5f) < middle ? colorTop : colorBot;
}

[FsInfo]
entryPoint = main

[ResourceMapping]
userDataNode[0].visibility = 2
userDataNode[0].type = IndirectUserDataVaPtr
userDataNode[0].offsetInDwords = 0
userDataNode[0].sizeInDwords = 1
userDataNode[0].indirectUserDataCount = 0
userDataNode[1].visibility = 2
userDataNode[1].type = StreamOutTableVaPtr
userDataNode[1].offsetInDwords = 3
userDataNode[1].sizeInDwords = 1
userDataNode[2].visibility = 64
userDataNode[2].type = DescriptorTableVaPtr
userDataNode[2].offsetInDwords = 7
userDataNode[2].sizeInDwords = 1
userDataNode[2].next[0].type = DescriptorConstBuffer
userDataNode[2].next[0].offsetInDwords = 0
userDataNode[2].next[0].sizeInDwords = 4
userDataNode[2].next[0].set = 0x00000001
userDataNode[2].next[0].binding = 1
userDataNode[2].next[0].strideInDwords = 0

[GraphicsPipelineState]
enableMultiView = 0
unlinked = 1
enableColorExportShader = 1
; CHECK-LABEL: amdgpu_ps_main:
; CHECK:         s_getpc_b64 s[8:9]
; CHECK-NEXT:    s_mov_b32 s8, s0
; CHECK-NEXT:    v_add_f32_e32 v0, -0.5, v3
; CHECK-NEXT:    s_load_dwordx4 s[8:11], s[8:9], 0x0
; CHECK-NEXT:    s_mov_b32 s0, s1
; CHECK-NEXT:    s_mov_b32 s6, s2
; CHECK-NEXT:    s_mov_b32 s32, 0
; CHECK-NEXT:    v_cvt_i32_f32_e32 v0, v0
; CHECK-NEXT:    v_cmp_lt_i32_e32 vcc, 7, v0
; CHECK-NEXT:    v_cndmask_b32_e64 v0, 0, 1, vcc
; CHECK-NEXT:    v_lshlrev_b32_e32 v0, 4, v0
; CHECK-NEXT:    s_waitcnt lgkmcnt(0)
; CHECK-NEXT:    s_add_u32 s8, s8, s4
; CHECK-NEXT:    s_getpc_b64 s[4:5]
; CHECK-NEXT:    s_addc_u32 s9, s9, 0
; CHECK-NEXT:    s_mov_b32 s1, s5
; CHECK-NEXT:    s_mov_b32 s7, s5
; CHECK-NEXT:    s_load_dwordx4 s[0:3], s[0:1], 0x0
; CHECK-NEXT:    s_mov_b32 s4, 0
; CHECK-NEXT:    s_waitcnt lgkmcnt(0)
; CHECK-NEXT:    buffer_load_dwordx4 v[0:3], v0, s[0:3], 0 offen
; CHECK-NEXT:    s_waitcnt_depctr 0xffe3
; CHECK-NEXT:    s_mov_b64 s[0:1], s[8:9]
; CHECK-NEXT:    s_mov_b64 s[2:3], s[10:11]
; CHECK-NEXT:    s_swappc_b64 s[30:31], s[6:7]
